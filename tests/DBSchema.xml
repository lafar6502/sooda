<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="../DBSchema.xsl" ?>
<schema xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://sooda.sourceforge.net/schemas/DBSchema.xsd">
    <datasource name="default" type="Sooda.Sql.SqlDataSource" />
    <datasource name="xmldata1" type="Sooda.Xml.XmlDataSource" />

    <class name="Role" cached="false" readOnly="true" precacheAll="false">
        <table name="_Role">
            <field name="Id" dbcolumn="id" type="Integer" primaryKey="true" />
            <field name="Name" dbcolumn="name" type="String" size="64" nullable="true" />
        </table>

        <collectionManyToMany name="Members" relation="ContactToRole" masterField="0" />

        <const name="Employee" key="1" />
        <const name="Manager" key="2" />
        <const name="Customer" key="3" />
    </class>

    <class name="ContactType" cached="true" precacheAll="false">
        <table name="ContactType">
            <field name="Code" dbcolumn="code" type="String" size="16" primaryKey="true" />
            <field name="Description" dbcolumn="description" type="String" size="64" nullable="true" />
        </table>

        <const name="Employee" key="Employee" />
        <const name="Manager" key="Manager" />
        <const name="Customer" key="Customer" />
    </class>

    <class name="Contact" cached="true">
        <table name="Contact">
            <field name="ContactId" dbcolumn="id" type="Integer" primaryKey="true" />
            <field name="PrimaryGroup" dbcolumn="primary_group" type="Integer" references="Group" nullable="true" onDelete="Cascade" />
            <field name="Type" dbcolumn="type" type="String" size="16" references="ContactType" />
            <field name="Name" dbcolumn="name" type="String" size="64" nullable="false" />
            <field name="Active" dbcolumn="active" type="Integer" />
        </table>
        <table name="Contact">
            <field name="ContactId" dbcolumn="id" type="Integer" primaryKey="true" />
            <field name="LastSalary" dbcolumn="last_salary" type="Decimal" size="20" precision="10" nullable="true" />
        </table>

        <collectionManyToMany name="Roles" relation="ContactToRole" masterField="1" />
        <collectionManyToMany name="Vehicles" relation="ContactToVehicle" masterField="1" />
        <collectionManyToMany name="Bikes" relation="ContactToBike" masterField="1" />

        <const name="Mary" key="1" />
        <const name="Ed" key="2" />
        <const name="Eva" key="3" />
    </class>

    <class name="KeyGen">
        <table name="KeyGen">
            <field name="key_name" dbcolumn="key_name" type="String" size="64" primaryKey="true" />
            <field name="key_value" dbcolumn="key_value" type="Integer" />
        </table>
    </class>

    <class name="Group" cached="true">
        <table name="_Group">
            <field name="Id" dbcolumn="id" type="Integer" primaryKey="true" />
            <field name="Manager" dbcolumn="manager" type="Integer" references="Contact" onDelete="Cascade" prefetch="2" />
            <field name="Name" dbcolumn="name" type="String" size="64" nullable="true" />
        </table>

        <collectionOneToMany name="Members" class="Contact" foreignField="PrimaryGroup" />
        <collectionOneToMany name="Managers" class="Contact" foreignField="PrimaryGroup" where="Type='Employee'" />
    </class>

    <class name="Vehicle" subclassSelectorField="Type">
        <table name="Vehicle">
            <field name="Id" dbcolumn="id" type="Integer" primaryKey="true" />
            <field name="Type" dbcolumn="type" type="Integer" />
            <field name="Name" dbcolumn="name" type="String" size="64" nullable="true" />
        </table>
    </class>

    <class name="Car" subclassSelectorValue="1" inheritFrom="Vehicle">
        <table name="Vehicle">
            <field name="Id" dbcolumn="id" type="Integer" primaryKey="true" />
            <field name="ABS" dbcolumn="abs" type="Integer" nullable="false" />
            <field name="FourWheelDrive" dbcolumn="four_wheel_drive" type="Integer" nullable="false" />
        </table>
    </class>

    <class name="Bike" subclassSelectorValue="2" inheritFrom="Vehicle">
        <table name="Bike">
            <field name="Id" dbcolumn="id" type="Integer" primaryKey="true" />
            <field name="TwoWheels" dbcolumn="two_wheels" type="Integer" nullable="false" />
        </table>
    </class>

    <class name="SuperBike" subclassSelectorValue="3" inheritFrom="Bike" />
    <class name="MegaSuperBike" subclassSelectorValue="4" inheritFrom="SuperBike" />
    <class name="AbstractMegaSuperBike" inheritFrom="MegaSuperBike" />
    <class name="ConcreteMegaSuperBikeA" subclassSelectorValue="5" inheritFrom="AbstractMegaSuperBike" />
    <class name="ConcreteMegaSuperBikeB" subclassSelectorValue="6" inheritFrom="AbstractMegaSuperBike" />

    <class name="ExtendedBike" subclassSelectorValue="7" inheritFrom="Bike">
        <table name="ExtendedBike">
            <field name="Id" dbcolumn="id" type="Integer" primaryKey="true" />
            <field name="ExtendedBikeInfo" dbcolumn="extended_bike_info" type="String" size="64" nullable="false" />
        </table>
    </class>

    <class name="AllDataTypes">
        <table name="AllDataTypes">
            <field name="Id" type="Integer" dbcolumn="id" primaryKey="true" />
            <field name="BoolVal" type="Boolean" nullable="true" dbcolumn="bool_val" />
            <field name="NnBoolVal" type="Boolean" dbcolumn="nn_bool_val" />
            <field name="IntVal" type="Integer" nullable="true" dbcolumn="int_val" />
            <field name="NnIntVal" type="Integer" dbcolumn="nn_int_val" />
            <field name="Int64Val" type="Long" nullable="true" dbcolumn="int64_val" />
            <field name="NnInt64Val" type="Long" dbcolumn="nn_int64_val" />
            <field name="StringVal" type="String" size="64" nullable="true" dbcolumn="string_val" />
            <field name="NnStringVal" type="String" size="64" dbcolumn="nn_string_val" />
            <field name="DateVal" type="DateTime" nullable="true" dbcolumn="date_val" />
            <field name="NnDateVal" type="DateTime" dbcolumn="nn_date_val" />
            <field name="FloatVal" type="Float" nullable="true" dbcolumn="float_val" />
            <field name="NnFloatVal" type="Float" dbcolumn="nn_float_val" />
            <field name="DoubleVal" type="Double" nullable="true" dbcolumn="double_val" />
            <field name="NnDoubleVal" type="Double" dbcolumn="nn_double_val" />
            <field name="DecimalVal" type="Decimal" nullable="true" dbcolumn="decimal_val" />
            <field name="NnDecimalVal" type="Decimal" dbcolumn="nn_decimal_val" />
        </table>
    </class>

    <class name="PKBool">
        <table name="PKBool">
            <field name="Id" type="Boolean" dbcolumn="id" primaryKey="true" />
            <field name="Data" type="String" size="64" nullable="true" dbcolumn="data" />
            <field name="Parent" type="Boolean" dbcolumn="parent" references="PKBool" />
        </table>

        <collectionManyToMany name="Parents" relation="RelStringToBool" masterField="0" />
    </class>

    <class name="PKGuid">
        <table name="PKGuid">
            <field name="Id" type="Guid" dbcolumn="id" primaryKey="true" />
            <field name="Data" type="String" size="64" nullable="true" dbcolumn="data" />
            <field name="Parent" type="Guid" dbcolumn="parent" references="PKGuid" />
        </table>
    </class>

    <class name="PKDateTime">
        <table name="PKDateTime">
            <field name="Id" type="DateTime" dbcolumn="id" primaryKey="true" />
            <field name="Data" type="String" size="64" nullable="true" dbcolumn="data" />
            <field name="Parent" type="DateTime" dbcolumn="parent" references="PKDateTime" />
        </table>

        <collectionManyToMany name="Parents" relation="RelInt64ToDateTime" masterField="0" />
    </class>

    <class name="PKInt32">
        <table name="PKInt32">

            <field name="Id" type="Integer" dbcolumn="id" primaryKey="true" />
            <field name="Data" type="String" size="64" nullable="true" dbcolumn="data" />
            <field name="Parent" type="Integer" dbcolumn="parent" references="PKInt32" />
        </table>

        <collectionManyToMany name="Children" relation="RelInt32ToString" masterField="1" />
    </class>

    <class name="PKInt64">
        <table name="PKInt64">
            <field name="Id" type="Long" dbcolumn="id" primaryKey="true" />
            <field name="Data" type="String" size="64" nullable="true" dbcolumn="data" />
            <field name="Parent" type="Long" dbcolumn="parent" references="PKInt64" />
        </table>

        <collectionManyToMany name="Children" relation="RelInt64ToDateTime" masterField="1" />
    </class>

    <class name="PKString">
        <table name="PKString">
            <field name="Id" type="String" size="64" dbcolumn="id" primaryKey="true" />
            <field name="Data" type="String" size="64" nullable="true" dbcolumn="data" />
            <field name="Parent" type="String" size="64" dbcolumn="parent" references="PKString" />
        </table>

        <collectionManyToMany name="Children" relation="RelStringToBool" masterField="1" />
        <collectionManyToMany name="Parents" relation="RelInt32ToString" masterField="0" />
    </class>

    <class datasource="xmldata1" name="XmlTest1">
        <table name="XmlTest1">
            <field name="Id" type="Integer" size="64" dbcolumn="id" primaryKey="true" />
            <field name="Data" type="String" size="64" nullable="true" dbcolumn="data" />
            <field name="Parent" type="Integer" size="64" dbcolumn="parent" references="XmlTest1" />
        </table>
    </class>

    <class name="MultiKey" cached="true">
        <table name="MultiKey">
            <field name="Contact" dbcolumn="contact_id" type="Integer" primaryKey="true" />
            <field name="Group" dbcolumn="group_id" type="Integer" primaryKey="true" />
            <field name="Value" dbcolumn="value" type="Integer" />
        </table>
    </class>

    <relation name="ContactToRole">
        <table name="ContactRole">
            <field name="Contact" dbcolumn="contact_id" type="Integer" references="Contact" primaryKey="true" />
            <field name="Role" dbcolumn="role_id" type="Integer" references="Role" />
        </table>
    </relation>

    <relation name="ContactToVehicle">
        <table name="ContactVehicle">
            <field name="Contact" dbcolumn="contact_id" type="Integer" references="Contact" primaryKey="true" />
            <field name="Vehicle" dbcolumn="vehicle_id" type="Integer" references="Vehicle" />
        </table>
    </relation>

    <relation name="ContactToBike">
        <table name="ContactBike">
            <field name="Contact" dbcolumn="contact_id" type="Integer" references="Contact" primaryKey="true" />
            <field name="Bike" dbcolumn="bike_id" type="Integer" references="Bike" />
        </table>
    </relation>

    <relation name="RelInt32ToString">
        <table name="RelInt32ToString">
            <field name="ll" dbcolumn="ll" type="Integer" references="PKInt32" />
            <field name="rr" dbcolumn="rr" type="String" size="64" references="PKString" />
        </table>
    </relation>

    <relation name="RelInt64ToDateTime">
        <table name="RelInt64ToDateTime">
            <field name="ll" dbcolumn="ll" type="Long" references="PKInt64" />
            <field name="rr" dbcolumn="rr" type="DateTime" references="PKDateTime" />
        </table>
    </relation>

    <relation name="RelStringToBool">
        <table name="RelStringToBool">
            <field name="ll" dbcolumn="ll" type="String" size="64" references="PKString" />
            <field name="rr" dbcolumn="rr" type="Boolean" references="PKBool" />
        </table>
    </relation>
</schema>
