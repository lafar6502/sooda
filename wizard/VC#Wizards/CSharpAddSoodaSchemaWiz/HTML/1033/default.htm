<HTML DIR="LTR">
    <HEAD>
        <TITLE>
            Add Sooda support to project
        </TITLE>
        <META NAME="vs_targetSchema" CONTENT="http://schemas.microsoft.com/intellisense/ie5">
            <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
                <STYLE TYPE="text/css">
                    @import url();
                </STYLE>

                <SCRIPT>
                    var strURL = "../../../";
                    strURL += window.external.GetHostLocale();
                    strURL += "/NewStyles.css";
                    document.styleSheets(0).imports(0).href = strURL;
                </SCRIPT>

                <SYMBOL NAME="INDEXER_TYPE" TYPE=text VALUE="">
                </SYMBOL>
                <SYMBOL NAME="COMMENT" TYPE=text VALUE="">
                </SYMBOL>
                <SYMBOL NAME="INDEXER_TEXT" TYPE=text VALUE="">
                </SYMBOL>
            </HEAD>
            <BODY BGCOLOR="buttonface" TOPMARGIN="0" LEFTMARGIN="0" RIGHTMARGIN="0" BOTTOMMARGIN="0" ONLOAD="InitDocument(document);" ONKEYDOWN="if (!bValidating) OnKey();" ONKEYPRESS="if (!bValidating) OnPress();">
                <table cellpadding="0" cellspacing="0" width="100%" height="100%">
                    <tr style="background-color: white">
                        <td height="79" style="border-bottom: 1px solid black">
                            <img src="titlebanner.jpg" />
                        </td>
                        <td>
                        </td>
                    </tr>
                    <tr height="100%">
                        <td colspan="2" style="padding: 10px" valign="top">
                                <p>
                                    This wizard will add Sooda support to your project. It will create a schema file <b>SoodaSchema.xml</b> and modify project build
                                events so that the stubs are automatically regenerated before each build. Settings you enter here are
                                stored in <b>App.config</b> file.
                            </p>
                            

                            <table width="80%">
                                <tr>
                                    <td>Schema file:</td>
                                    <td>SoodaSchema.xml</td>
                                </tr>
                                <tr>
                                    <td>Presets:</td>
                                    <td>
                                        <select id="database_type" style="width: 300px" onchange="database_type_changed()">
                                            <option value="mssql">MS SQL Server 2000 / MSDE with SqlClient Data Provider</option>
                                            <option value="oracle_oracle">Oracle using Oracle Data Provider</option>
                                            <option value="oracle_dotnet">Oracle using MS.NET Data Provider</option>
                                            <option value="postgresql_npgsql">PostgreSQL with Npgsql Data Provider</option>
                                            <option value="mysql4_bytefx">MySQL 4.x with ByteFX Data Provider</option>
                                            <option value="oledb">OLE DB Provider (any database)</option>
                                            <option>(custom)</option>
                                        </select>
                                    </td>
                                </tr>
                                <tr>
                                    <td valign="top">Database connection type:</td>
                                    <td>
                                        <textarea style="font-family: Tahoma; font-size: 10px; width: 300px; font-size: inherit" id="connection_type" rows="3">
                                        </textarea>
                                    </td>
                                </tr>
                                <tr>
                                    <td>Connection string:</td>
                                    <td>
                                        <textarea style="font-family: Tahoma; font-size: 10px; width: 300px; font-size: inherit" id="connection_string" rows="3">
                                        </textarea>
                                    </td>
                                </tr>
                                <tr>
                                    <td>SQL Dialect:</td>
                                    <td>
                                        <select id="sql_dialect" style="width: 300px">
                                            <option value=""></option>
                                            <option value="mssql">Microsoft SQL Server 2000</option>
                                            <option value="oracle">Oracle 8i, 9i, 10g</option>
                                            <option value="postgresql">PostgreSQL 7.x, 8.x</option>
                                            <option value="mysql4">MySQL 4.x</option>
                                        </select>
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2" align="right" style="padding: 10px">
                            <input style="font-size: 12px" id="TestBtn" value="Test Connection..." type="button" onclick="alert('Not implemented yet')" />&#160;
                            <input style="font-size: 12px" id="FinishBtn" type="button" onclick="OnWizFinish(document)" value="&#160;Finish&#160;" />&#160;
                            <input style="font-size: 12px" id="CancelBtn" type="button" onclick="window.external.Finish(document, 'cancel')" value="&#160;Cancel&#160;" />
                        </td>
                    </tr>
                </table>
<SCRIPT LANGUAGE="JSCRIPT">

var strParameters = "";

function set_connection_type(txt,is_readonly)
{
    document.all.connection_type.value = txt;
    if (is_readonly)
        document.all.disabled = true;
    else
        document.all.disabled = false;

}

function set_connection_string(txt)
{
    document.all.connection_string.value = txt;
}

function set_sql_dialect(txt)
{
    document.all.sql_dialect.value = txt;
}

function database_type_changed()
{
    var t = document.all.database_type.value;

    switch (t)
    {
        case 'mssql':
            set_connection_type('System.Data.SqlClient.SqlConnection, System.Data, Version=1.0.3300.0, Culture=neutral, PublicKeyToken=b77a5c561934e089',false);
            set_connection_string('Data Source=;Initial Catalog=;User Id=;Password=');
            set_sql_dialect('mssql');
            break;

        case 'postgresql_npgsql':
            set_connection_type('Npgsql.NpgsqlConnection, Npgsql, Version=1.0.5000.0, Culture=neutral, PublicKeyToken=5d8b90d52f46fda7', false);
            set_connection_string('server=;user id=;password=;database=;encoding=unicode');
            set_sql_dialect('postgresql');
            break;

        case 'mysql4_bytefx':
            set_connection_type('TODO', false);
            set_connection_string('TODO');
            set_sql_dialect('mysql4');
            break;

        case 'oracle_dotnet':
            set_connection_type('TODO', false);
            set_connection_string('TODO');
            set_sql_dialect('oracle');
            break;

        case 'oracle_oracle':
            set_connection_type('TODO', false);
            set_connection_string('TODO');
            set_sql_dialect('oracle');
            break;

        default:
            set_connection_type('',true);
            set_connection_string('');
            set_sql_dialect('');
            break;
    }
}

function InitDocument(document)
{
    setDirection();

    if (window.external.FindSymbol("DOCUMENT_FIRST_LOAD"))
    {
        var L_WizardDialogTitle_Text = "Add Sooda Support Wizard";
        window.external.AddSymbol("WIZARD_DIALOG_TITLE", L_WizardDialogTitle_Text);
        window.external.SetDefaults(document);
    }

    window.external.Load(document);

    database_type_changed();
}

function OnFinish(document)
{
    window.external.AddSymbol("CONNECTION_TYPE", document.all.connection_type.value);
    window.external.AddSymbol("CONNECTION_STRING", document.all.connection_string.value);
    window.external.AddSymbol("SQL_DIALECT", document.all.sql_dialect.value);
    OnWizFinish(document);
}

</SCRIPT>
<SCRIPT ID="INCLUDE_SCRIPT" LANGUAGE="JSCRIPT">
</SCRIPT>
<SCRIPT ID="INCLUDE_COMMON" LANGUAGE="JSCRIPT">
</SCRIPT>
<SCRIPT>
    var strPath = "../../../";
    strPath += window.external.GetHostLocale();
    var strScriptPath = strPath + "/Script.js";
    var strCommonPath = strPath + "/Common.js";
    document.scripts("INCLUDE_SCRIPT").src = strScriptPath;
    document.scripts("INCLUDE_COMMON").src = strCommonPath;
</SCRIPT>
</BODY>
</HTML>
