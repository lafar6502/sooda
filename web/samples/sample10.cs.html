<pre xml:space='preserve'><span class='csharp'><span class='k'>using</span> System;
<span class='k'>using</span> Sooda;

<span class='k'>using</span> Soodawind.Objects;

<span class='k'>class</span> Sample4 
{
    <span class='k'>static</span> <span class='k'>void</span> Main()
    {
        <span class='k'>using</span> (SoodaTransaction transaction = <span class='k'>new</span> SoodaTransaction()) 
        {
            Category c = Category.Load(1);

            <span class='c'>// display all beverage products</span>
            <span class='k'>foreach</span> (Product p <span class='k'>in</span> c.ProductsInThisCategory)
            {
                Console.WriteLine(<span class='s'>&quot;Product: {0} category: {1} price: {2}&quot;</span>, p.Name, p.Category.Name, p.UnitPrice);
            }

            Console.WriteLine(<span class='s'>&quot;The total number of beverages: {0}&quot;</span>, c.ProductsInThisCategory.Count);

            Product p2 = Product.Load(1);

            <span class='c'>// remove a particular product from the collection</span>
            p2.ProductsInThisCategory.Remove(p2);

            <span class='c'>// the new p2.Category == null (the product is no longer in the collection)</span>
            Console.WriteLine(<span class='s'>&quot;New category of product #1 is null: {0}&quot;</span>, p2.Category == <span class='k'>null</span>);
            
            <span class='c'>// iterate over first 3 products (in no particular order)</span>
            <span class='k'>foreach</span> (Product p <span class='k'>in</span> c.ProductsInThisCategory.SelectFirst(3))
            {
                <span class='c'>// do something</span>
            }

            <span class='c'>// note that the order is fixed after the collection is first accessed. subsequent accesses</span>
            <span class='c'>// can rely on the fact.</span>

            <span class='c'>// iterate over last 3 products (in no particular order)</span>
            <span class='k'>foreach</span> (Product p <span class='k'>in</span> c.ProductsInThisCategory.SelectLast(3))
            {
                <span class='c'>// do something</span>
            }
            
            <span class='c'>// iterate over the specified range of products (in no particular order)</span>
            <span class='k'>foreach</span> (Product p <span class='k'>in</span> c.ProductsInThisCategory.SelectRange(3,10))
            {
                <span class='c'>// do something</span>
            }
             
            <span class='c'>// iterate over the products sorted by name</span>
            <span class='k'>foreach</span> (Product p <span class='k'>in</span> c.ProductsInThisCategory.Sort(SoodaOrderBy.Ascending(<span class='s'>&quot;Name&quot;</span>).GetComparer()))
            {
                <span class='c'>// do something</span>
            }
            
            <span class='c'>// get the snapshot of this collection. Updates to c.ProductsInThisCategory (direct or indirect)</span>
            <span class='c'>// will not affect the snapshot</span>
            ProductList snapshot = c.ProductsInThisCategory.GetSnapshot();

            <span class='k'>foreach</span> (Product p <span class='k'>in</span> snapshot)
            {
                <span class='c'>// do something</span>
            }

            <span class='c'>// another way to iterate the collection. Note that ProductList returns strongly-typed instances</span>
            <span class='c'>// of Product</span>

            <span class='k'>for</span> (<span class='k'>int</span> i = 0; i &lt; snapshot.Count; ++i)
            {
                Product p3 = snapshot[i];
            }
        }
    }
}
</span>
</pre>